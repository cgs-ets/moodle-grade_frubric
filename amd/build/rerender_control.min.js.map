{"version":3,"sources":["../src/rerender_control.js"],"names":["define","$","FeditorHelper","Templates","RerenderControl","mode","self","FEDITOR","prototype","main","rerendercreatedRegrade","rerenderCreate","rerenderUpdate","context","getCriteriaJSON","definitionid","document","getElementById","getAttribute","data","edit","rerender","regradealert","forEach","element","criteria","push","render","done","html","js","Y","log","editor","replaceNode","fail","ex","querySelector","value","fromrr","fromrerenderupdate","init","control"],"mappings":"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","sourcesContent":["define(['jquery', 'gradingform_frubric/feditor_helper', 'core/templates'],\n    function ($, FeditorHelper, Templates) {\n        'use strict';\n\n        function init(mode) {\n            Y.log(\"Rerender control...\");\n            let control = new RerenderControl(mode);\n            control.main();\n\n        }\n\n        function RerenderControl(mode) {\n            const self = this;\n            self.FEDITOR = 'gradingform_frubric/frubriceditor';\n            self.mode = mode;\n\n        }\n\n        RerenderControl.prototype.main = function () {\n            var self = this;\n\n            if (self.mode == 'regrade') {\n                self.rerendercreatedRegrade();\n            }\n\n            if (self.mode == 'rerendercreate') {\n                self.rerenderCreate();\n            }\n\n            if (self.mode == 'rerenderupdate') {\n                self.rerenderUpdate();\n            }\n\n        }\n\n        /**\n         * Called when the rubric is already in used  students\n         * where graded and the rubric is going to be updated.\n         */\n        RerenderControl.prototype.rerendercreatedRegrade = function () {\n            //Y.log(\"render regrade...\");\n            var self = this;\n\n            const context = FeditorHelper.getCriteriaJSON();\n            const definitionid = document.getElementById(\"cont\").getAttribute(\"data-definition-id\");\n\n            const data = {\n                edit: 1,\n                mode: 'edit',\n                rerender: 1,\n                definitionid: definitionid,\n                regradealert: 1,\n                \"criteria\": []\n            }\n\n            context.forEach(function (element) {\n                data.criteria.push(element);\n            });\n\n\n            Templates.render(self.FEDITOR, data)\n                .done(function (html, js) {\n                    Y.log(html);\n                    // Replace with editor with previous values\n                    const editor = document.getElementById('cont');\n                    Templates.replaceNode(editor, html, js);\n\n                }).fail(function (ex) {\n                    Y.log(\"error...\");\n                    Y.log(ex);\n                });\n            document.querySelector('input[name=\"regrade\"]').value = '-1'; // Change the value to allow submiting\n        }\n\n\n        RerenderControl.prototype.rerenderCreate = function () {\n            Y.log('rerenderCreate ....');\n            const context = FeditorHelper.getCriteriaJSON();\n            const definitionid = document.getElementById(\"cont\").getAttribute(\"data-definition-id\");\n\n\n            const data = {\n                // edit: 1,\n                mode:'create',\n                rerender: 1,\n                fromrr: 1,\n                definitionid: definitionid,\n                fromrerenderupdate: 1,\n                \"criteria\": []\n            }\n\n            context.forEach(function (element) {\n                data.criteria.push(element);\n            });\n            Y.log(data)\n            Templates.render(self.FEDITOR, data)\n                .done(function (html, js) {\n                    Y.log(html);\n                    // Replace with editor with previous values\n                    const editor = document.getElementById('cont');\n                    Templates.replaceNode(editor, html, js);\n\n                }).fail(function (ex) {\n                    Y.log(\"error...\");\n                    Y.log(ex);\n                });\n        }\n\n        RerenderControl.prototype.rerenderUpdate = function () {\n            var self = this;\n            Y.log('rerenderUpdate ....');\n            const context = FeditorHelper.getCriteriaJSON();\n            const definitionid = document.getElementById(\"cont\").getAttribute(\"data-definition-id\");\n\n            Y.log(context);\n\n            const data = {\n                // edit: 1,\n                mode: 'edit',\n                rerender: 1,\n                fromrr: 1,\n                definitionid: definitionid,\n                fromrerenderupdate: 1,\n                \"criteria\": []\n            }\n\n            context.forEach(function (element) {\n                data.criteria.push(element);\n            });\n\n            Templates.render(self.FEDITOR, data)\n                .done(function (html, js) {\n                    Y.log(html);\n                    // Replace with editor with previous values\n                    const editor = document.getElementById('cont');\n                    Templates.replaceNode(editor, html, js);\n\n                }).fail(function (ex) {\n                    Y.log(\"error...\");\n                    Y.log(ex);\n                });\n        }\n\n        return {\n            init: init\n        };\n    });"],"file":"rerender_control.min.js"}