{"version":3,"sources":["../src/rerender_control.js"],"names":["define","$","FeditorHelper","Templates","RerenderControl","mode","self","FEDITOR","prototype","main","rerendercreatedRegrade","context","getCriteriaJSON","definitionid","document","getElementById","getAttribute","data","edit","rerender","regradealert","forEach","element","criteria","push","render","done","html","js","Y","log","editor","replaceNode","fail","ex","querySelector","value","rerenderCreate","fromrr","fromrerenderupdate","rerenderUpdate","init","control"],"mappings":"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","sourcesContent":["define(['jquery', 'gradingform_frubric/feditor_helper', 'core/templates'],\n    function ($, FeditorHelper, Templates) {\n        'use strict';\n\n        function init(mode) {\n            Y.log(\"Rerender control...\");\n            let control = new RerenderControl(mode);\n            control.main();\n\n        }\n\n        function RerenderControl(mode) {\n            const self = this;\n            self.FEDITOR = 'gradingform_frubric/frubriceditor';\n            self.mode = mode;\n\n        }\n\n        RerenderControl.prototype.main = function () {\n            var self = this;\n\n            // if (self.mode == 'regrade') {\n            //     self.rerendercreatedRegrade();\n            // }\n\n            // if (self.mode == 'rerendercreate') {\n            //     self.rerenderCreate();\n            // }\n\n            // if (self.mode == 'rerenderupdate') {\n            //     self.rerenderUpdate();\n            // }\n\n            // if (self.mode == 'edit') {\n            //    // self.rerenderUpdate();\n            // }\n\n            \n            // if (document.querySelector('input[name=\"forrerender\"]').value != '') {\n            //     const data = JSON.parse(document.querySelector('input[name=\"forrerender\"]').value);\n            //     Templates.render(self.FEDITOR, data)\n            //     .done(function (html, js) {\n            //         Y.log(html);\n            //         // Replace with editor with previous values\n            //         const editor = document.getElementById('cont');\n            //         Templates.replaceNode(editor, html, js);\n    \n            //     }).fail(function (ex) {\n            //         Y.log(\"error...\");\n            //         Y.log(ex);\n            //     });\n            // }\n\n\n        }\n\n        /**\n         * Called when the rubric is already in used  students\n         * where graded and the rubric is going to be updated.\n         */\n        RerenderControl.prototype.rerendercreatedRegrade = function () {\n            //Y.log(\"render regrade...\");\n            var self = this;\n\n            const context = FeditorHelper.getCriteriaJSON();\n            const definitionid = document.getElementById(\"cont\").getAttribute(\"data-definition-id\");\n\n            const data = {\n                edit: 1,\n                mode: 'edit',\n                rerender: 1,\n                definitionid: definitionid,\n                regradealert: 1,\n                \"criteria\": []\n            }\n\n            context.forEach(function (element) {\n                data.criteria.push(element);\n            });\n\n\n            Templates.render(self.FEDITOR, data)\n                .done(function (html, js) {\n                    Y.log(html);\n                    // Replace with editor with previous values\n                    const editor = document.getElementById('cont');\n                    Templates.replaceNode(editor, html, js);\n\n                }).fail(function (ex) {\n                    Y.log(\"error...\");\n                    Y.log(ex);\n                });\n            document.querySelector('input[name=\"regrade\"]').value = '-1'; // Change the value to allow submiting\n        }\n\n\n        RerenderControl.prototype.rerenderCreate = function () {\n            Y.log('rerenderCreate ....');\n            const context = FeditorHelper.getCriteriaJSON();\n            const definitionid = document.getElementById(\"cont\").getAttribute(\"data-definition-id\");\n\n\n            const data = {\n                // edit: 1,\n                mode:'create',\n                rerender: 1,\n                fromrr: 1,\n                definitionid: definitionid,\n                fromrerenderupdate: 1,\n                \"criteria\": []\n            }\n\n            context.forEach(function (element) {\n                data.criteria.push(element);\n            });\n            // Y.log(data)\n            Templates.render(self.FEDITOR, data)\n                .done(function (html, js) {\n                    Y.log(html);\n                    // Replace with editor with previous values\n                    const editor = document.getElementById('cont');\n                    Templates.replaceNode(editor, html, js);\n\n                }).fail(function (ex) {\n                    Y.log(\"error...\");\n                    Y.log(ex);\n                });\n        }\n\n        RerenderControl.prototype.rerenderUpdate = function () {\n            var self = this;\n            Y.log('rerenderUpdate ....');\n            const context = FeditorHelper.getCriteriaJSON();\n            const definitionid = document.getElementById(\"cont\").getAttribute(\"data-definition-id\");\n\n            // Y.log(context);\n\n            const data = {\n                // edit: 1,\n                mode: 'edit',\n                rerender: 1,\n                fromrr: 1,\n                definitionid: definitionid,\n                fromrerenderupdate: 1,\n                \"criteria\": []\n            }\n\n            context.forEach(function (element) {\n                data.criteria.push(element);\n            });\n            Y.log(data);\n            Templates.render(self.FEDITOR, data)\n                .done(function (html, js) {\n                    // Y.log(html);\n                    // Replace with editor with previous values\n                    const editor = document.getElementById('cont');\n                    Templates.replaceNode(editor, html, js);\n\n                }).fail(function (ex) {\n                    Y.log(\"error...\");\n                    Y.log(ex);\n                });\n        }\n\n        return {\n            init: init\n        };\n    });"],"file":"rerender_control.min.js"}