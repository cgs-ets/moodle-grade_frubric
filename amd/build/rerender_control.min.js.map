{"version":3,"sources":["../src/rerender_control.js"],"names":["define","$","FeditorHelper","Templates","RerenderControl","mode","self","FEDITOR","prototype","main","rerendercreatedRegrade","rerenderCreate","rerenderUpdate","Y","log","context","getCriteriaJSON","definitionid","document","getElementById","getAttribute","data","edit","rerender","regradealert","forEach","element","criteria","push","render","done","html","js","editor","replaceNode","fail","ex","debug","querySelector","value","fromrr","fromrerenderupdate","init","control"],"mappings":"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","sourcesContent":["define(['jquery', 'gradingform_frubric/feditor_helper', 'core/templates'],\n    function ($, FeditorHelper, Templates) {\n        'use strict';\n\n        function init(mode) {\n            Y.log(\"Rerender control...\");\n            // const context = FeditorHelper.getCriteriaJSON();\n            // const definitionid = document.getElementById(\"cont\").getAttribute(\"data-definition-id\")\n            // const FEDITOR = 'gradingform_frubric/frubriceditor';\n\n            // const data = {\n            //     edit: 1,\n            //     rerender: 1,\n            //     definitionid: definitionid,\n            //     regradealert: 1,\n            //     \"criteria\": []\n            // }\n\n            // context.forEach(function (element) {\n            //     data.criteria.push(element);\n            // });\n\n\n            // Templates.render(FEDITOR, data)\n            //     .done(function (html, js) {\n            //         Y.log(html);\n            //         // Replace with editor with previous values\n            //         const editor = document.getElementById('cont');\n            //         Templates.replaceNode(editor, html, js);\n\n            //     }).fail(function (ex) {\n            //         Log.debug(\"error...\");\n            //         Log.debug(ex);\n            //     });\n\n            //     document.querySelector('input[name=\"regrade\"]').value = '-1'; // Change the value to allow submiting\n\n            let control = new RerenderControl(mode);\n            control.main();\n\n        }\n\n        function RerenderControl(mode) {\n            const self = this;\n            self.FEDITOR = 'gradingform_frubric/frubriceditor';\n            self.mode = mode;\n\n        }\n\n        RerenderControl.prototype.main = function () {\n            var self = this;\n\n            if (self.mode == 'regrade') {\n                self.rerendercreatedRegrade();\n            }\n\n            if (self.mode == 'rerendercreate') {\n                self.rerenderCreate();\n            }\n\n            if (self.mode == 'rerenderupdate') {\n                self.rerenderUpdate();\n            }\n\n        }\n\n        /**\n         * Called when the rubric is already in used  students\n         * where graded and the rubric is going to be updated.\n         */\n        RerenderControl.prototype.rerendercreatedRegrade = function () {\n            Y.log(\"render regrade...\");\n            var self = this;\n\n            const context = FeditorHelper.getCriteriaJSON();\n            const definitionid = document.getElementById(\"cont\").getAttribute(\"data-definition-id\");\n\n            const data = {\n                edit: 1,\n                mode: 'edit',\n                rerender: 1,\n                definitionid: definitionid,\n                regradealert: 1,\n                \"criteria\": []\n            }\n\n            context.forEach(function (element) {\n                data.criteria.push(element);\n            });\n\n\n            Templates.render(self.FEDITOR, data)\n                .done(function (html, js) {\n                    Y.log(html);\n                    // Replace with editor with previous values\n                    const editor = document.getElementById('cont');\n                    Templates.replaceNode(editor, html, js);\n\n                }).fail(function (ex) {\n                    Y.debug(\"error...\");\n                    Y.debug(ex);\n                });\n\n            document.querySelector('input[name=\"regrade\"]').value = '-1'; // Change the value to allow submiting\n\n        }\n\n        RerenderControl.prototype.rerenderCreate = function () {\n            Y.log('rerenderCreate ....');\n            const context = FeditorHelper.getCriteriaJSON();\n            const definitionid = document.getElementById(\"cont\").getAttribute(\"data-definition-id\");\n\n\n            const data = {\n                // edit: 1,\n                mode:'create',\n                rerender: 1,\n                fromrr: 1,\n                definitionid: definitionid,\n                fromrerenderupdate: 1,\n                \"criteria\": []\n            }\n\n            context.forEach(function (element) {\n                data.criteria.push(element);\n            });\n            Y.log(data)\n            Templates.render(self.FEDITOR, data)\n                .done(function (html, js) {\n                    Y.log(html);\n                    // Replace with editor with previous values\n                    const editor = document.getElementById('cont');\n                    Templates.replaceNode(editor, html, js);\n\n                }).fail(function (ex) {\n                    Y.debug(\"error...\");\n                    Y.debug(ex);\n                });\n        }\n\n        RerenderControl.prototype.rerenderUpdate = function () {\n            var self = this;\n            Y.log('rerenderUpdate ....');\n            const context = FeditorHelper.getCriteriaJSON();\n            const definitionid = document.getElementById(\"cont\").getAttribute(\"data-definition-id\");\n\n            Y.log(context);\n\n            const data = {\n                // edit: 1,\n                mode: 'edit',\n                rerender: 1,\n                fromrr: 1,\n                definitionid: definitionid,\n                fromrerenderupdate: 1,\n                \"criteria\": []\n            }\n\n            context.forEach(function (element) {\n                data.criteria.push(element);\n            });\n\n            Templates.render(self.FEDITOR, data)\n                .done(function (html, js) {\n                    Y.log(html);\n                    // Replace with editor with previous values\n                    const editor = document.getElementById('cont');\n                    Templates.replaceNode(editor, html, js);\n\n                }).fail(function (ex) {\n                    Y.debug(\"error...\");\n                    Y.debug(ex);\n                });\n        }\n\n        return {\n            init: init\n        };\n    });"],"file":"rerender_control.min.js"}