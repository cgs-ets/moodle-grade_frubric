define ("gradingform_frubric/evaluate_control",["jquery","core/log","core/templates","core/ajax","core/str","gradingform_frubric/feditor_helper"],function(a,b,c,d,e,f){'use strict';function g(a){var b=this;b.criteria=a;b.definitionID=document.getElementById("advancedgrading-criteria").getAttribute("data-definition-id")}g.prototype.main=function(){var a=this;a.setupEvents(a.criteria)};g.prototype.setupEvents=function(a){var b=this;a.forEach(function(a){var b=this,c=document.getElementById("advancedgrading-frubric-criteria-".concat(a.criteriaid)),d=c.children[0].children,e=document.getElementById("advancedgrading-frubric-criteria-".concat(a.criteriaid,"-level-grade"));e.addEventListener("focus",b.focusEvaluationHandler.bind(this,b));Array.from(d).forEach(function(a){var c=a.children[1],d=c.children;Array.from(d).forEach(function(a){if(a instanceof HTMLInputElement){switch(a.type){case"checkbox":a.addEventListener("click",b.clickDescriptorHandler.bind(b));break;}}})},b)},b);var c=document.getElementById("advancedgrading-".concat(b.definitionID,"-frubric-total-grade"));c.addEventListener("focus",b.focusEvaluationTotalHandler.bind(this,b))};g.prototype.clickDescriptorHandler=function(a){this;b.debug("CHECKED...");b.debug(a);var c=a.target.id.split("-"),d=c[3],e=c[5],g=c[c.length-1],h=JSON.parse(f.getLevelsJSON(d));h[e].definition.replace(/\\/g,"");var i=JSON.parse(h[e].definition),j=h[e].descriptors;j.filter(function(a){if(a.descriptorid==g){a.checked=!a.checked}},g);i.descriptors=j;i=JSON.stringify(i);h[e].definition=i;document.getElementById("advancedgrading-frubric-".concat(d,"-leveljson")).value=JSON.stringify(h)};g.prototype.focusEvaluationHandler=function(a,c){b.debug("focusEvaluationHandler");b.debug(c);document.getElementById(c.target.id).addEventListener("change",a.onChangeEvaluationHandler.bind(this,a))};g.prototype.onChangeEvaluationHandler=function(a,c){b.debug("onChangeEvaluationHandler");c.target.classList.remove("total-input-error");var d=parseFloat(document.getElementById(c.target.id).value),e=document.getElementById(c.target.id+"-out-of-value").innerText.split("/");e=parseFloat(e[e.length-1]);if(d>e||0>d){c.target.classList.add("total-input-error")}};g.prototype.focusEvaluationTotalHandler=function(a,c){b.debug("focusEvaluationHandler");document.getElementById(c.target.id).addEventListener("change",a.onChangeTotalEvaluationHandler.bind(this,a))};g.prototype.onChangeTotalEvaluationHandler=function(a,c){b.debug("onChangeTotalEvaluationHandler");c.target.classList.remove("total-input-error");var d=parseFloat(document.getElementById(c.target.id).value),e=document.getElementById(c.target.id+"-given").innerText.split("/");e=parseFloat(e[e.length-1]);if(d>e){c.target.classList.add("total-input-error")}};return{init:function(a){b.debug("gradingform_frubric: Evaluate Control...");a=JSON.parse(a);var c=new g(a.criteria);c.main(a.criteria)}}});
//# sourceMappingURL=evaluate_control.min.js.map
