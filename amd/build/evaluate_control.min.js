define ("gradingform_frubric/evaluate_control",["jquery","core/log","core/templates","core/ajax","core/str","gradingform_frubric/feditor_helper"],function(a,b,c,d,e,f){'use strict';function g(a){var b=this;b.criteria=a;b.totalScore=0;b.definitionID=document.getElementById("advancedgrading-criteria").getAttribute("data-definition-id")}g.prototype.main=function(){var a=this;a.setupEvents(a.criteria);document.getElementById("advancedgrading-".concat(a.definitionID,"-frubric-total-grade")).value=a.totalScore};g.prototype.setupEvents=function(a){var b=this;a.forEach(function(a){var b=this,c=document.getElementById("advancedgrading-frubric-criteria-".concat(a.criteriaid)),d=c.children[0].children;Array.from(d).forEach(function(a){var c=a.children[1],d=c.children;Array.from(d).forEach(function(a){if(a instanceof HTMLInputElement){switch(a.type){case"checkbox":a.addEventListener("click",b.clickDescriptorHandler.bind(b));break;case"number":break;}}})},b)},b)};g.prototype.clickDescriptorHandler=function(a){this;b.debug("CHECKED...");b.debug(a);var c=a.target.id.split("-"),d=c[3],e=c[5],g=c[c.length-1],h=JSON.parse(f.getLevelsJSON(d));h[e].definition.replace(/\\/g,"");var i=JSON.parse(h[e].definition),j=h[e].descriptors;j.filter(function(a){if(a.descriptorid==g){a.checked=!a.checked}},g);i.descriptors=j;i=JSON.stringify(i);h[e].definition=i;document.getElementById("advancedgrading-frubric-".concat(d,"-leveljson")).value=JSON.stringify(h)};g.prototype.onblurScoreHandler=function(a,c){b.debug("onblurScoreHandler");b.debug(a);var d=parseFloat(document.getElementById(c.target.id).value);b.debug(d);a.totalScore=a.totalScore+d;b.debug(a.totalScore);document.getElementById("advancedgrading-".concat(a.definitionID,"-frubric-total-grade")).value=a.totalScore};g.prototype.clickEvaluationHandler=function(a,c){b.debug("clickEvaluationHandler");a.currentScore=parseFloat(document.getElementById(c.target.id).value);a.totalScore=parseFloat(document.getElementById("advancedgrading-".concat(a.definitionID,"-frubric-total-grade")).value);document.getElementById(c.target.id).addEventListener("change",a.onChangeEvaluationHandler.bind(this,a));b.debug(a)};g.prototype.onChangeEvaluationHandler=function(a,c){b.debug("onChangeEvaluationHandler");a.totalScore=a.totalScore-a.currentScore;a.totalScore=a.totalScore+parseFloat(document.getElementById(c.target.id).value);document.getElementById("advancedgrading-".concat(a.definitionID,"-frubric-total-grade")).value=a.totalScore;a.currentScore=0;b.debug(a)};return{init:function(a){b.debug("gradingform_frubric: Evaluate Control...");a=JSON.parse(a);var c=new g(a.criteria);c.main(a.criteria)}}});
//# sourceMappingURL=evaluate_control.min.js.map
