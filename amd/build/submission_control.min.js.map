{"version":3,"sources":["../src/submission_control.js"],"names":["define","SubmissionControl","submiteddata","definitionID","self","document","getElementById","getAttribute","prototype","main","checkCriteria","checkScore","criteria","Object","entries","forEach","key","value","scoregiven","console","log","classList","remove","querySelector","hasAttribute","hidden","add","removeAttribute","maxallowed","innerText","split","length","parseFloat","enteredscore","maxscore","init","JSON","parse","control"],"mappings":"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","sourcesContent":["/* eslint-disable max-len */\n/* eslint-disable promise/always-return */\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n\n/**\n * @package   gradingform_frubric\n * @copyright 2021 Veronica Bermegui\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['core/log'],\n    function (Log) {\n        'use strict';\n\n        function init(submiteddata, definitionID) {\n\n            submiteddata = JSON.parse(submiteddata);\n            const control = new SubmissionControl(submiteddata, definitionID);\n            control.main(submiteddata, definitionID);\n        }\n\n        function SubmissionControl(submiteddata, definitionID) {\n            const self = this;\n            self.definitionID = definitionID;\n            self.submiteddata = submiteddata;\n            self.definitionID = document.getElementById('advancedgrading-criteria').getAttribute('data-definition-id');\n\n\n        }\n\n        SubmissionControl.prototype.main = function () {\n            const self = this;\n            self.checkCriteria(self.submiteddata);\n            self.checkScore(self.criteria);\n        }\n\n        SubmissionControl.prototype.checkCriteria = function () {\n            var self = this;\n            Object.entries(self.submiteddata.criteria).forEach(([key, value]) => {\n\n                // Check score given to the criterion\n                const scoregiven = document.getElementById(`advancedgrading-frubric-criteria-${key}-level-grade`);\n                console.log(\"checkCriteria: \")\n                if (scoregiven.value != '') {\n                    scoregiven.classList.remove('total-input-error');\n                    if (!document.querySelector('span.frubric-no-descriptor-error').hasAttribute('hidden')) {\n                        document.querySelector('span.frubric-no-descriptor-error').hidden = true;\n                    }\n                } else {\n                    scoregiven.classList.add('total-input-error');\n                    document.querySelector('span.frubric-no-descriptor-error').removeAttribute('hidden');\n                }\n\n                let maxallowed = document.getElementById(`advancedgrading-frubric-criteria-${key}-level-grade-out-of-value`).innerText.split('/');\n                maxallowed = maxallowed[maxallowed.length - 1];\n\n                if (parseFloat(scoregiven.value) > parseFloat(maxallowed)) {\n                    scoregiven.classList.add('total-input-error');\n                }\n\n                if (!document.querySelector('span.frubric-no-score-error').hasAttribute('hidden')) {\n                    document.querySelector('span.frubric-no-score-error').hidden = true;\n                }\n            });\n\n        }\n\n        SubmissionControl.prototype.checkScore = function () {\n            var self = this;\n            console.log(this);\n            let scoregiven = document.getElementById(`advancedgrading-${self.definitionID}-frubric-total-grade`);\n            scoregiven.classList.remove('total-input-error');\n            let enteredscore = parseFloat(scoregiven.value);\n            let maxscore = document.getElementById(`advancedgrading-${self.definitionID}-frubric-total-grade-given`).innerText.split('/');\n            maxscore = parseFloat(maxscore[maxscore.length - 1]);\n            console.log(\"checkScore: enteredscore\", enteredscore)\n            if (enteredscore > maxscore || enteredscore < 0) {\n                scoregiven.classList.add('total-input-error');\n            }\n\n        }\n\n\n\n\n\n\n\n        return {\n            init: init\n        };\n    });"],"file":"submission_control.min.js"}