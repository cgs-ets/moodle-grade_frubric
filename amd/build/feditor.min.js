define ("gradingform_frubric/feditor",["jquery","core/log","core/templates","core/ajax","core/str","gradingform_frubric/feditor_helper"],function(a,b,c,d,e,f){'use strict';function g(a){b.debug("Feditor: initialising...");var c=this;c.CRITERION_ROW="gradingform_frubric/editor_criterion_row";c.criterioncollection=a}g.prototype.main=function(){var a=this;b.debug(this);a.setupEvents()};g.prototype.setupEvents=function(){var a=this;document.getElementById("addCriterion").addEventListener("click",a.addCriterion.bind(this))};g.prototype.addCriterion=function(){var a=this,d=document.querySelectorAll(".criterion-header").length,e={id:"frubric-criteria-NEWID".concat(d+1),criteriongroupid:d+1,description:"Click to edit criterion",new:1};c.render(a.CRITERION_ROW,e).done(function(b,e){c.appendNodeContents(document.getElementById("criteriaTable"),b,e);var g=document.querySelector("tbody").lastElementChild,h={id:g.getAttribute("data-criterion-group"),cid:"frubric-criteria-NEWID".concat(d+1),status:"NEW",new:1,description:"",rowindex:g.rowIndex,definitionid:document.getElementById("cont").getAttribute("data-definition-id"),levels:[]};if(""!=f.getCriteriaJSON()){a.criterioncollection=JSON.parse(document.getElementById("id_criteria").value)}a.criterioncollection.push(h);document.getElementById("id_criteria").value=JSON.stringify(a.criterioncollection)}).fail(function(a){b.debug("error...");b.debug(a)})};return{init:function(){var a=f.getMode(),b;if("edit"===a){b=document.getElementById("id_criteria").value}else{var c={id:1,cid:"frubric-criteria-NEWID".concat(document.querySelectorAll(".criterion-header").length),status:"NEW",description:"",rowindex:1,definitionid:document.getElementById("cont").getAttribute("data-definition-id"),levels:[],sumscore:"",totaloutof:""};b=[c];document.getElementById("id_criteria").value=JSON.stringify(b)}var d=new g(b);d.main()}}});
//# sourceMappingURL=feditor.min.js.map
