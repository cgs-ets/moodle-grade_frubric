define ("gradingform_frubric/feditor",["core/log","core/templates","gradingform_frubric/feditor_helper"],function(a,b,c){'use strict';function d(a){var b=this;b.CRITERION_ROW="gradingform_frubric/editor_criterion_row";b.FEDITOR="gradingform_frubric/frubriceditor";b.criterioncollection=a}d.prototype.main=function(){var a=this;a.setupEvents()};d.prototype.setupEvents=function(){var a=this;document.getElementById("addCriterion").addEventListener("click",a.addCriterion.bind(this))};d.prototype.addCriterion=function(){var d=this,e=document.querySelectorAll(".criterion-header").length,f={id:"frubric-criteria-NEWID".concat(e+1),criteriongroupid:e+1,new:1};b.render(d.CRITERION_ROW,f).done(function(a,f){b.appendNodeContents(document.getElementById("criteriaTable"),a,f);var g=document.querySelector("tbody").lastElementChild,h={id:g.getAttribute("data-criterion-group"),cid:"frubric-criteria-NEWID".concat(e+1),status:"NEW",new:1,description:"",rowindex:g.rowIndex,definitionid:document.getElementById("cont").getAttribute("data-definition-id"),levels:[],sumscore:""};if(""!=c.getCriteriaJSON()){d.criterioncollection=JSON.parse(document.getElementById("id_criteria").value)}d.criterioncollection.push(h);c.setCriteriaJSON(d.criterioncollection);c.setHiddenCriteriaJSON(d.criterioncollection)}).fail(function(b){a.debug(b)})};return{init:function(){var a=c.getMode(),b,e=0==JSON.parse(document.getElementById("id_criteria").value).length;if("create"===a&&e){var f={id:"1",cid:"frubric-criteria-NEWID".concat(document.querySelectorAll(".criterion-header").length),status:"NEW",description:"",rowindex:1,definitionid:document.getElementById("cont").getAttribute("data-definition-id"),levels:[],sumscore:"",totaloutof:""};b=[f];c.setCriteriaJSON(b);c.setHiddenCriteriaJSON(b)}if("edit"===a||"create"===a&&document.getElementById("id_criteria").classList.contains("is-invalid")!=void 0){b=document.getElementById("id_criteria").value}else{var f={id:"1",cid:"frubric-criteria-NEWID".concat(document.querySelectorAll(".criterion-header").length),status:"NEW",description:"",rowindex:1,definitionid:document.getElementById("cont").getAttribute("data-definition-id"),levels:[],sumscore:"",totaloutof:""};b=[f];c.setCriteriaJSON(b);c.setHiddenCriteriaJSON(b)}var g=new d(b);g.main()}}});
//# sourceMappingURL=feditor.min.js.map
