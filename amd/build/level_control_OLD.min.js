function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(!a)return;if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return _arrayLikeToArray(a,b)}function _arrayLikeToArray(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function _iterableToArrayLimit(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function _arrayWithHoles(a){if(Array.isArray(a))return a}define ("gradingform_frubric/level_control_OLD",["jquery","core/log","core/str","core/notification","gradingform_frubric/feditor_helper"],function(a,b,c,d,f){'use strict';function g(a,b){var c=this;c.level=a;c.mode=b}g.prototype.main=function(){var a=this;b.debug("main");b.debug(a);a.setupEvents(a.level)};g.prototype.setupEvents=function(a){var c=this;b.debug("Level control: setupEvents");var d=_slicedToArray(a.children,2),e=d[0],f=d[1];b.debug(f);var g=f.children[0];e.addEventListener("click",this.deleteLevel.bind(c));g.addEventListener("click",this.editlevelhandler.bind(c))};g.prototype.deleteLevel=function(a){b.debug("deleteLevel");b.debug(a);c.get_strings([{key:"confirm",component:"gradingform_frubric"},{key:"confirmdeletelevel",component:"gradingform_frubric"},{key:"yes"},{key:"no"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],function(){var c=document.getElementById("criteriaTable"),d=a.target.parentNode.parentNode.parentNode,e=f.getPreviousElement(d,".criterion-header"),g=JSON.parse(document.getElementById("id_criteria").value);if(0<e.getAttribute("data-criterion-levels").length){for(var h=JSON.parse(e.getAttribute("data-criterion-levels")),k=f.getDistanceFromCriterionHeader(d,".criterion-header"),l=h[k],m=d.getAttribute("data-criterion-group"),n,o=0;o<g.length;o++){if(g[o].id==m){b.debug("en el if");g[o].status="UPDATE";n=g[o].levels;break}}for(var p=0;p<n.length;p++){if(n[p].dbid==l){n[p].status="DELETE";break}}}document.getElementById("id_criteria").value=JSON.stringify(g);c.deleteRow(d.rowIndex)},function(){})})};g.prototype.editlevelhandler=function(a){b.debug("editlevelhandler");b.debug(a);b.debug(this);var c=a.target;if("Click to edit Level description"==c.innerHTML||"Click to edit Mark"==c.innerHTML){c.innerHTML=""}c.removeAttribute("disabled");c.focus();c.addEventListener("change",this.changeLevelHandlerDisabled.bind(this,c));c.addEventListener("focusout",this.focusoutHandlerDisabled)};g.prototype.changeLevelHandlerDisabled=function(a,c){b.debug("changeLevelHandlerDisabled");var d=c.target.parentNode.parentNode.parentNode.getAttribute("data-criterion-group"),e=c.target.parentNode.parentNode.parentNode,g=f.getPreviousElement(e,".criterion-header"),h=0<g.getAttribute("data-criterion-levels").length?JSON.parse(g.getAttribute("data-criterion-levels")):[],j=f.getCriteriaJSON(),k=c.target.parentNode.parentNode.parentNode.rowIndex,l=d+"_"+k;if(0<h.length){l=h[k-1]!=void 0?"".concat(d,"_").concat(h[k-1]):l}var m=j.filter(function(a,b){var d=c.target.parentNode.parentNode.parentNode.getAttribute("data-criterion-group");a.rowindex=b;if(d==a.id){return a}},c);if(m[0].levels!=void 0){for(var n=null,o=m[0].levels,p=0;p<o.length;p++){if(o[p].id!=l){continue}else{n=o[p];break}}if(null!=n){if(c.target.classList.contains("mark_txtarea")){n.score=c.target.value}else{n.definition=c.target.value}if("CREATED"==n.status||"UPDATED"==n.status){n.status="UPDATE"}}else{var q={id:l,status:"NEW",score:"",definition:""};if(c.target.classList.contains("mark_txtarea")){q.score=c.target.value}else{q.definition=c.target.value}m[0].levels.push(q)}if("edit"==f.getMode()){if(!0!=m[0].cid.includes("NEWID")){m[0].status="UPDATE"}else{m[0].status="NEW"}}}document.getElementById("id_criteria").value=JSON.stringify(j);c.target.setAttribute("disabled",!0)};g.prototype.focusoutHandlerDisabled=function(a){b.debug("focusoutHandlerDisabled");a.target.setAttribute("disabled",!0)};return{init:function(a){b.debug("Level control...");var c=f.getMode(),d=document.getElementById(a),e=new g(d,c);e.main()}}});
//# sourceMappingURL=level_control_OLD.min.js.map
